<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>D.C Tumaini - 10th Anniversary Celebration</title>
  <script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      font-family: 'Arial', sans-serif;
    }
    
    body {
      background: linear-gradient(to bottom, #0a0a0a, #1a1a1a);
      color: #fff;
      text-align: center;
      padding: 20px;
      min-height: 100vh;
    }
    
    .container {
      max-width: 500px;
      margin: 0 auto;
    }
    
    h1 {
      font-size: 28px;
      margin: 15px 0;
      background: linear-gradient(to right, #FFD700, #FFA500);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
    }
    
    .instructions {
      background: rgba(255, 215, 0, 0.1);
      padding: 15px;
      border-radius: 10px;
      margin: 15px 0;
      text-align: left;
    }
    
    input {
      width: 100%;
      padding: 12px;
      margin: 8px 0;
      border-radius: 8px;
      border: 1px solid rgba(255, 215, 0, 0.3);
      background: rgba(0, 0, 0, 0.5);
      color: #fff;
    }
    
    button {
      background: linear-gradient(to right, #FFD700, #FFA500);
      color: #000;
      border: none;
      padding: 12px 20px;
      border-radius: 8px;
      font-weight: bold;
      cursor: pointer;
      margin: 10px 0;
      width: 100%;
    }
    
    .frame-container {
      position: relative;
      width: 400px;
      height: 600px;
      margin: 20px auto;
    }
    
    .frame {
      width: 100%;
      height: 100%;
      position: absolute;
      top: 0;
      left: 0;
      z-index: 2;
    }
    
    .user-photo {
      position: absolute;
      top: 135px;
      left: 50%;
      transform: translateX(-50%);
      width: 300px;
      height: 290px;
      border-radius: 10px;
      object-fit: cover;
      z-index: 1;
    }
    
    .caption {
      position: absolute;
      bottom: 80px;
      left: 50%;
      transform: translateX(-50%);
      font-size: 22px;
      font-weight: bold;
      color: #FFD700;
      text-shadow: 1px 1px 3px rgba(0, 0, 0, 0.8);
      z-index: 3;
      width: 100%;
      text-align: center;
    }
    
    .message {
      margin: 20px 0;
      font-size: 18px;
      color: #FFD700;
    }
    
    .loading {
      display: none;
      margin: 15px 0;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>D.C TUMAINI 10TH ANNIVERSARY</h1>
    
    <div class="instructions">
      <p><strong>How to create your badge:</strong></p>
      <ol>
        <li>Enter your name below</li>
        <li>Upload your photo</li>
        <li>Download your personalized badge</li>
      </ol>
    </div>
    
    <input type="text" id="userName" placeholder="Enter your name">
    <input type="file" id="photoUpload" accept="image/*">
    
    <div class="frame-container" id="badgeContainer">
      <img class="user-photo" id="userPhoto" src="data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='300' height='290' viewBox='0 0 300 290'><rect width='100%' height='100%' fill='%23333'/><text x='50%' y='50%' font-family='Arial' font-size='18' fill='%23aaa' text-anchor='middle' dominant-baseline='middle'>Your Photo Here</text></svg>">
      <img class="frame" id="frameImage" src="frame.png" alt="Anniversary Frame">
      <div class="caption" id="captionText">Your Name</div>
    </div>
    
    <div class="message" id="messageText">
      Create your personalized attendance badge!
    </div>
    
    <div class="loading" id="loadingSpinner">
      Generating your badge...
    </div>
    
    <button id="downloadBtn">Download Your Badge</button>
  </div>

  <script>
    document.addEventListener('DOMContentLoaded', function() {
      const userNameInput = document.getElementById('userName');
      const photoUploadInput = document.getElementById('photoUpload');
      const userPhoto = document.getElementById('userPhoto');
      const captionText = document.getElementById('captionText');
      const messageText = document.getElementById('messageText');
      const downloadBtn = document.getElementById('downloadBtn');
      const loadingSpinner = document.getElementById('loadingSpinner');
      const frameImage = document.getElementById('frameImage');
      
      let hasUploadedPhoto = false;
      
      // Handle photo upload
      photoUploadInput.addEventListener('change', function(event) {
        const file = event.target.files[0];
        if (file) {
          hasUploadedPhoto = true;
          const reader = new FileReader();
          reader.onload = function(e) {
            userPhoto.src = e.target.result;
          };
          reader.readAsDataURL(file);
        }
      });
      
      // Handle name input
      userNameInput.addEventListener('input', function() {
        const name = userNameInput.value.trim();
        if (name) {
          captionText.textContent = name;
          messageText.textContent = `${name} is going to the 10th anniversary celebrations!`;
        } else {
          captionText.textContent = 'Your Name';
          messageText.textContent = 'Create your personalized attendance badge!';
        }
      });
      
      // Handle download
      downloadBtn.addEventListener('click', function() {
        if (!hasUploadedPhoto) {
          alert('Please upload a photo first');
          return;
        }
        
        if (!userNameInput.value.trim()) {
          alert('Please enter your name');
          return;
        }
        
        loadingSpinner.style.display = 'block';
        
        // Use html2canvas to capture the badge
        html2canvas(document.getElementById('badgeContainer'), {
          useCORS: true,
          scale: 2,
          logging: false,
          backgroundColor: null
        }).then(canvas => {
          const downloadLink = document.createElement('a');
          const fileName = `DC_Tumaini_10th_Anniversary_${userNameInput.value.trim()}.png`;
          
          downloadLink.href = canvas.toDataURL('image/png');
          downloadLink.download = fileName;
          document.body.appendChild(downloadLink);
          downloadLink.click();
          document.body.removeChild(downloadLink);
          
          loadingSpinner.style.display = 'none';
        }).catch(error => {
          console.error('Error generating image:', error);
          alert('Error generating image. Please try again.');
          loadingSpinner.style.display = 'none';
        });
      });
      
      // Handle frame image loading error
      frameImage.onerror = function() {
        alert('Error: Frame image not found. Make sure "frame.png" is in the same folder as this HTML file.');
      };
    });
  </script>
</body>
</html>